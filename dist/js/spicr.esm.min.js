// Spicr v1.0.10 | thednp Â© 2023 | MIT-License
function t(t,e){const s=e&&("object"==typeof(n=e)&&n instanceof HTMLElement)?e:document;var n;return"object"==typeof t?t:s.querySelector(t)}const e=/iPhone|iPad|iPod|Android/i;let s=!1;s=navigator.userAgentData?navigator.userAgentData.brands.some(t=>e.test(t.brand)):e.test(navigator.userAgent);const n=s,o="ontouchstart"in window||"msMaxTouchPoints"in navigator,a="onmouseleave"in document?["mouseenter","mouseleave"]:["mouseover","mouseout"];const r=!!(()=>{let t=!1;try{const a=Object.defineProperty({},"passive",{get:()=>(t=!0,t)});e=document,n=()=>{},function(t,e,s,n){const o=n||!1;t.addEventListener(e,s,o)}(e,s="DOMContentLoaded",(function t(a){a.target===e&&(n.apply(e,[a]),function(t,e,s,n){const o=n||!1;t.removeEventListener(e,s,o)}(e,s,t,o))}),o=a)}catch(t){throw Error("Passive events are not supported")}var e,s,n,o;return t})()&&{passive:!0};function i(t){return"true"===t||"false"!==t&&(Number.isNaN(+t)?""===t||"null"===t?null:t:+t)}const l=t=>Object.keys(t);const c={};function d(t,e,s){const n=e.trim().split(/[,|;]/),o={};return n.forEach(e=>{const n=e.split(/[:|=]/),a=n[0],r=n[1],i=/y/i.test(a)||/v/i.test(r)?"offsetHeight":"offsetWidth";/x/i.test(a)&&console.log("processLayerData",a,t.offsetWidth,i,parseFloat(r)*t[i]/100,r),s&&/%/.test(r)&&!/z/i.test(a)?o[a]=r:o[a]=/%/.test(r)?parseFloat(r)*t[i]/100:parseFloat(r)}),o}const u={delay:250,duration:500,easing:"easingCubicOut",interval:5e3,touch:!0,pause:"hover",slides:{itemsPerPage:3,totalRealItems:5,activeAlign:"center",gap:8,axis:"x",autoloop:!0}};function f(t){const e=function(t){const e={};return["translate","rotate","scale","transform-origin","opacity","duration","delay","easing"].forEach(s=>{e["transform-origin"===s?"origin":s]=t.getAttribute("data-"+s)}),e}(t),{translate:s,rotate:n,origin:o,opacity:a,easing:r}=e;let{scale:i,duration:l,delay:c}=e;return i=parseFloat(i),l=+l,c=+c,{translate:s?d(t,s):"",rotate:n?d(t,n):"",origin:o?d(t,o,1):"",scale:Number.isNaN(i)?"":i,opacity:"false"!==a?1:0,duration:Number.isNaN(l)?u.duration:l,delay:Number.isNaN(c)?0:c,easing:r||u.easing}}function m(t){return Array.from(t.getElementsByClassName("spicr-layer"))}function g(t,e,s){const n=t[e]||t[0],o=m(n),a=n.classList.contains("active"),r=t[s],i=r&&r.getElementsByClassName("item-bg")[0],l=i?f(i):0;return l?(Object.keys(l).forEach(t=>{/translate|rotate/.test(t)&&l[t]instanceof Object&&Object.keys(l[t]).forEach(e=>{l[t][e]=-l[t][e]})}),o.map(t=>c.layer(t,0,l))):o.map(t=>c.layer(t,a?0:1))}function y(e,s){const d=t(e,f);var f;const m=function(t,e,s,n){const o={...t.dataset},a={},r={};return l(o).forEach(t=>{const e=n&&t.includes(n)?t.replace(n,"").replace(/[A-Z]/,t=>t.toLowerCase()):t;r[e]=i(o[t])}),l(s).forEach(t=>{s[t]=i(s[t])}),l(e).forEach(t=>{a[t]=t in s?s[t]:t in r?r[t]:e[t]}),a}(d,u,s||{}),y=this;y.tweens=[];let h=y.tweens,p={},x=a;o&&n&&(x=["touchstart","touchend"]);const v=m.pause,E=m.touch,{gap:T,axis:L,autoloop:N}=m.slides,z=m.interval,b=d.getElementsByClassName("item"),A=d.querySelectorAll("[data-slide]"),I=A.length&&A[0],C=A.length&&A[1],O=d.getElementsByClassName("spicr-pages")[0],P=O&&O.querySelectorAll("[data-slide-to]");let w=null,X=null,$=0,S=0;const _=d.classList.contains("spicr-slides"),F=!_&&d.classList.contains("spicr-slider"),j=d.classList.contains("spicr-carousel");function D(){d.classList.contains("paused")||(d.classList.add("paused"),S||(clearInterval(w),w=null))}function B(){d.classList.contains("paused")&&(d.classList.remove("paused"),S||(clearInterval(w),w=null,y.cycle()))}function M(t){if(t.preventDefault(),S)return;const e=t.target,s=e&&e.getAttribute("data-slide-to");e&&!e.classList.contains("active")&&s&&($=parseInt(s,10),y.slideTo($))}function Z(t){if(t.preventDefault(),S)return;this===C||C.contains(this)?$+=1:(this===I||I.contains(this))&&($-=1),y.slideTo($)}function k(t){p.isTouch||(p.startX=t.changedTouches[0].pageX,d.contains(t.target)&&(p.isTouch=!0,q(1)))}function H(t){p.isTouch&&(p.currentX=t.changedTouches[0].pageX,"touchmove"===t.type&&t.changedTouches.length>1&&t.preventDefault())}function R(t){if(p.isTouch&&!S&&(p.endX=p.currentX||t.changedTouches[0].pageX,p.isTouch)){if((!d.contains(t.target)||!d.contains(t.relatedTarget))&&Math.abs(p.startX-p.endX)<75)return;p.currentX<p.startX?$+=1:p.currentX>p.startX&&($-=1),p.isTouch=!1,y.slideTo($),q()}}function q(t){const e=t?"addEventListener":"removeEventListener";d[e]("touchmove",H,r),d[e]("touchend",R,r)}function U(t){const e=t?"addEventListener":"removeEventListener";"hover"===v&&z&&(d[e](x[0],D),d[e](x[1],B)),C&&C[e]("click",Z),I&&I[e]("click",Z),E&&b.length>1&&d[e]("touchstart",k,r),O&&O[e]("click",M)}function K(t){Array.from(P).map(t=>t.classList.remove("active")),t&&t.classList.add("active")}function W(t,e){$=e,b[e].classList.add("next"),S=!0,j&&t>-1&&b[t].offsetHeight!==b[e].offsetHeight&&(d.style.height=getComputedStyle(b[t]).height)}function Y(t,e){b[e].classList.add("active"),b[e].classList.remove("next"),b[t]&&b[t].classList.remove("active"),setTimeout(()=>{if(j&&(d.style.height=""),_){if(console.log("options.slides",m.slides),m.slides.autoloop){const t=V();console.log("nextItem (active 1)",e),console.log("ttlItemsFrActive",t);const s=e-t;console.log("indexOfFirstItemOnPg",s);const n=m.slides.itemsPerPage-1;console.log("maxIdxLClones",n);const o=m.slides.itemsPerPage+m.slides.totalRealItems+1-1;if(console.log("minIdxRClones",o),n>=s||s>=o){console.log("chkIsInCloneRange",s,n>=s>=o);const t=s>=o;console.log("isOnRight",t);let a=m.slides.totalRealItems;a=t?-a:a,console.log("moveByTtlItems",a);const r=e+a;$=r,console.log("realNextItem",r);const i=s+a;console.log("realFirstItemPg",i);let l=0;l="x"===L?b[0].offsetWidth:b[0].offsetHeight,console.log("itemLength",l);const c=-1*(i*l+T*i);console.log("pos",T,c),Array.from(b).forEach((t,e)=>{t.style.transform=`translate${L.toUpperCase()}(${c}px)`}),b[e].classList.remove("active"),b[r].classList.add("active"),e=r}}}else c.reset(d);S=!1,h=[];const t=new CustomEvent("afterTween",{detail:{newActive:e}});d.dispatchEvent(t),z&&!d.classList.contains("paused")&&y.cycle()},0)}function V(){let t=0;return"center"===m.slides.activeAlign?t=(m.slides.itemsPerPage-1)/2:"right"===m.slides.activeAlign&&(t=m.slides.itemsPerPage),t}_&&($=(N?m.slides.itemsPerPage:0)+V()+1-1,console.log("init index",$)),this.getActiveIndex=()=>{const t=d.getElementsByClassName("item active")[0];return Array.from(b).indexOf(t)},this.cycle=()=>{clearInterval(w),w=setTimeout(()=>{$+=1,y.slideTo($)},z)},this.slideTo=t=>{console.log("slideTonextIdx",t);let e=t;const s=this.getActiveIndex();console.log(s,e,S),s===e||S||(clearInterval(w),w=setTimeout(()=>{if(s<e||0===s&&e===b.length-1?X=1:(s>e||s===b.length-1&&0===e)&&(X=0),e<0?e=b.length-1:e>=b.length&&(e=0),console.log(" find the right next index",s,e,S),F){W(s,e);const t=-1!==s?g(b,s,e):g(b,s),n=-1!==s&&g(b,e);-1===s?t.length&&(h=h.concat(t)):(t.length&&(h=h.concat(t)),n.length&&(h=h.concat(n))),h.length?(h.reduce((t,e)=>t._duration+t._delay>e._duration+e._delay?t:e)._onComplete=()=>Y(s,e),h.forEach(t=>t.start())):Y(s,e),P&&K(P[e])}else if(_)W(s,e),h=c.slides(d,b,s,e,X,L,T),h.length?(h.reduce((t,e)=>t._duration+t._delay>e._duration+e._delay?t:e)._onComplete=()=>Y(s,e),h.forEach(t=>t.start())):Y(s,e);else if(j){W(s,e);const{delay:t,duration:n,easing:o}=u,a=b[s],r=b[e];h=c.carousel(d,b,s,e,X),h.length?(a&&a.offsetHeight!==r.offsetHeight&&h.push(c.fromTo(d,{height:parseFloat(getComputedStyle(a).height)},{height:parseFloat(getComputedStyle(r).height)},{easing:o,duration:n,delay:Math.max(...h.map(t=>t._delay+t._duration))||t})),h[h.length-1]._onComplete=()=>Y(s,e),h.forEach(t=>t.start())):Y(s,e),P&&K(P[e])}},1))},this.dispose=()=>{S&&h.forEach(t=>t.stop()),c.reset(d),p={},U(),clearInterval(w),delete d.Spicr},d.Spicr&&d.Spicr.dispose(),U(1),d.Spicr=y,d.getElementsByClassName("item active").length?z&&y.cycle():y.slideTo(0)}if(void 0===window.KUTE)throw Error("Spicr requires KUTE.js ^2.0.10");function h(t){const e=t instanceof Element?t:document;Array.from(e.querySelectorAll('[data-function="spicr"]')).forEach(t=>new y(t))}c.fromTo=window.KUTE.fromTo,c.carousel=function(t,e,s,n,o){const a=[],r=f(t),i={},l={},g={},y={},h=e[s],p=h&&m(h),x=m(e[n]),{translate:v}=r,{rotate:E}=r,{scale:T}=r,L=t.getAttribute("data-transform-origin"),{opacity:N}=r,{easing:z}=r;let b=r.duration||u.duration,A=r.delay||+b/2;if(N&&(i.opacity=1,l.opacity=0,g.opacity=0,y.opacity=1),(T||v||E)&&(i.transform={},l.transform={},g.transform={},y.transform={}),T&&(i.transform.scale=1,l.transform.scale=T,g.transform.scale=T,y.transform.scale=1),v){i.transform.translate3d=[0,0,0];let t=0,e=0,s=0;"x"in v&&(t=o?-v.x:v.x),"y"in v&&(e=o?-v.y:v.y),"Z"in v&&(s=o?-v.z:v.z),l.transform.translate3d=[t,e,s];let n=0,a=0,r=0;"x"in v&&(n=o?v.x:-v.x),"y"in v&&(a=o?v.y:-v.y),"Z"in v&&(r=o?v.z:-v.z),g.transform.translate3d=[n,a,r],y.transform.translate3d=[0,0,0]}if(E){i.transform.rotate3d=[0,0,0];let t=0,e=0,s=0;"x"in E&&(t=o?-E.x:E.x),"y"in E&&(e=o?-E.y:E.y),"Z"in E&&(s=o?-E.z:E.z),l.transform.rotate3d=[t,e,s];let n=0,a=0,r=0;"x"in E&&(n=o?E.x:-E.x),"y"in E&&(a=o?E.y:-E.y),"Z"in E&&(r=o?E.z:-E.z),g.transform.rotate3d=[n,a,r],y.transform.rotate3d=[0,0,0]}o||(p&&p.reverse(),x.reverse()),N||E||v||T||(b=50,A=0);const I={easing:z,duration:b},C=I;return p&&p.forEach((t,e)=>{if(I.delay=u.delay*e,a.push(c.fromTo(t,i,l,I)),L){const e=d(t,L);let s="50%",n="50%";const o="z"in e?` ${e.z}px`:"";"x"in e&&(s=/%/.test(e.x)?e.x:e.x+"px"),"y"in e&&(n=/%/.test(e.y)?e.y:e.y+"px"),t.style.transformOrigin=`${s} ${n}${o}`}}),x.forEach((t,e)=>{if(C.delay=(A+50)*e,a.push(c.fromTo(t,g,y,C)),L){const e=d(t,L);let s="50%",n="50%";const o="z"in e?` ${e.z}px`:"";"x"in e&&(s=/%/.test(e.x)?e.x:e.x+"px"),"y"in e&&(n=/%/.test(e.y)?e.y:e.y+"px"),t.style.transformOrigin=`${s} ${n}${o}`}}),a},c.layer=function(t,e,s){const n=s||f(t),o=t.classList.contains("item-bg"),a={},r={},{translate:i}=n,{rotate:l}=n,{scale:d}=n,{origin:m}=n;let{opacity:g}=n,{duration:y}=n,{easing:h}=n,p=n.delay||(o?0:u.delay);if(/InOut/.test(h)||s||(h=e?h.replace("In","Out"):h.replace("Out","In")),e||(y=o?y:1.5*y),p=e?p:0,g=!e&&o&&s?0:g,g&&(a.opacity=e?0:1,r.opacity=e?1:0),(d||i||l)&&(a.transform={},r.transform={},m)){let e="50%",s="50%";const n="z"in m?` ${m.z}px`:"";"x"in m&&(e=/%/.test(m.x)?m.x:m.x+"px"),"y"in m&&(s=/%/.test(m.y)?m.y:m.y+"px"),t.style.transformOrigin=`${e} ${s}${n}`}if(d&&(a.transform.scale=e?d:1,r.transform.scale=e?1:d),i){const t=e&&i.x?i.x:0,s=i.x&&!e?i.x:0,n=e&&i.y?i.y:0,o=i.y&&!e?i.y:0,l=e&&i.z?i.z:0,c=i.z&&!e?i.z:0;a.transform.translate3d=[t,n,l],r.transform.translate3d=[s,o,c]}if(l){const t=e&&l.x?l.x:0,s=!e&&l.x?l.x:0,n=e&&l.y?l.y:0,o=!e&&l.y?l.y:0,i=e&&l.z?l.z:0,c=!e&&l.z?l.z:0;a.transform.rotate3d=[t,n,i],r.transform.rotate3d=[s,o,c]}return g||l||i||d||(y=50,p=0),c.fromTo(t,a,r,{easing:h,duration:y,delay:p})},c.reset=function(t){Array.from(t.getElementsByClassName("spicr-layer")).forEach(t=>{t.style.opacity="",t.style.transform="",t.style.transformOrigin=""})},c.slides=function(t,e,s,n,o,a,r){const i=[],l=function(t,e){const s=function(t){const e={};return["translate","rotate","scale","transform-origin","opacity","duration","delay","easing","axis"].forEach(s=>{e["transform-origin"===s?"origin":s]=t.getAttribute("data-"+s)}),e}(t),{translate:n,rotate:o,origin:a,opacity:r,easing:i,axis:l}=s;let{scale:c,duration:f,delay:m}=s;return c=parseFloat(c),f=+f,m=+m,{axis:l,translate:n?d(e,n):"",rotate:o?d(t,o):"",origin:a?d(t,a,1):"",scale:Number.isNaN(c)?"":c,opacity:"false"!==r?1:0,duration:Number.isNaN(f)?u.duration:f,delay:Number.isNaN(m)?0:m,easing:i||u.easing}}(t,e[s]),f=e[s],{translate:m}=l,{easing:g}=(t.getAttribute("data-transform-origin"),l),y=l.duration||u.duration,h={},p={},x=getComputedStyle(f).getPropertyValue("transform"),v=new DOMMatrixReadOnly(x),E={X:v.m41,Y:v.m42,Z:v.m43};if(console.log("activeTranslate",E),m){console.log("elem translate",m),h.transform={},p.transform={},h.transform.translate3d=[E.X,E.Y,E.Z];let t=0,s=0,n=0;"x"in m&&("x"===a&&(m.x+=r),t=o?-m.x:m.x),"y"in m&&("y"===a&&(m.y+=r),s=o?-m.y:m.y),"z"in m&&("z"===a&&(m.z+=r),n=o?-m.z:m.z),console.log("elem translate after direction",m);const l=t+E.X,d=s+E.Y,u=n+E.Z;p.transform.translate3d=[l,d,u],console.log("fromTo",h.transform,p.transform),Array.from(e).forEach((t,e)=>{i.push(c.fromTo(t,h,p,{easing:g,duration:y}))})}return i},y.initComponent=h,document.body?h():document.addEventListener("DOMContentLoaded",h,{once:!0});Object.assign(y,{Version:"1.0.10"});export default y;
