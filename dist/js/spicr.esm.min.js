// Spicr v1.0.10 | thednp Â© 2023 | MIT-License
function t(t,e){const s=e&&("object"==typeof(n=e)&&n instanceof HTMLElement)?e:document;var n;return"object"==typeof t?t:s.querySelector(t)}const e=/iPhone|iPad|iPod|Android/i;let s=!1;s=navigator.userAgentData?navigator.userAgentData.brands.some(t=>e.test(t.brand)):e.test(navigator.userAgent);const n=s,a="ontouchstart"in window||"msMaxTouchPoints"in navigator,o="onmouseleave"in document?["mouseenter","mouseleave"]:["mouseover","mouseout"];const r=!!(()=>{let t=!1;try{const o=Object.defineProperty({},"passive",{get:()=>(t=!0,t)});e=document,n=()=>{},function(t,e,s,n){const a=n||!1;t.addEventListener(e,s,a)}(e,s="DOMContentLoaded",(function t(o){o.target===e&&(n.apply(e,[o]),function(t,e,s,n){const a=n||!1;t.removeEventListener(e,s,a)}(e,s,t,a))}),a=o)}catch(t){throw Error("Passive events are not supported")}var e,s,n,a;return t})()&&{passive:!0};function i(t){return"true"===t||"false"!==t&&(Number.isNaN(+t)?""===t||"null"===t?null:t:+t)}const l=t=>Object.keys(t);const c={};function d(t,e,s){const n=e.trim().split(/[,|;]/),a={};return n.forEach(e=>{const n=e.split(/[:|=]/),o=n[0],r=n[1],i=/y/i.test(o)||/v/i.test(r)?"offsetHeight":"offsetWidth";/x/i.test(o)&&console.log("processLayerData",o,t.offsetWidth,i,parseFloat(r)*t[i]/100,r),s&&/%/.test(r)&&!/z/i.test(o)?a[o]=r:a[o]=/%/.test(r)?parseFloat(r)*t[i]/100:parseFloat(r)}),a}const u={delay:250,duration:500,easing:"easingCubicOut",interval:5e3,touch:!0,pause:"hover",slides:{itemsPerPage:3,totalRealItems:5,activeAlign:"center",gap:8,axis:"x"}};function f(t){const e=function(t){const e={};return["translate","rotate","scale","transform-origin","opacity","duration","delay","easing"].forEach(s=>{e["transform-origin"===s?"origin":s]=t.getAttribute("data-"+s)}),e}(t),{translate:s,rotate:n,origin:a,opacity:o,easing:r}=e;let{scale:i,duration:l,delay:c}=e;return i=parseFloat(i),l=+l,c=+c,{translate:s?d(t,s):"",rotate:n?d(t,n):"",origin:a?d(t,a,1):"",scale:Number.isNaN(i)?"":i,opacity:"false"!==o?1:0,duration:Number.isNaN(l)?u.duration:l,delay:Number.isNaN(c)?0:c,easing:r||u.easing}}function m(t){return Array.from(t.getElementsByClassName("spicr-layer"))}function g(t,e,s){const n=t[e]||t[0],a=m(n),o=n.classList.contains("active"),r=t[s],i=r&&r.getElementsByClassName("item-bg")[0],l=i?f(i):0;return l?(Object.keys(l).forEach(t=>{/translate|rotate/.test(t)&&l[t]instanceof Object&&Object.keys(l[t]).forEach(e=>{l[t][e]=-l[t][e]})}),a.map(t=>c.layer(t,0,l))):a.map(t=>c.layer(t,o?0:1))}function y(e,s){const d=t(e,f);var f;const m=function(t,e,s,n){const a={...t.dataset},o={},r={};return l(a).forEach(t=>{const e=n&&t.includes(n)?t.replace(n,"").replace(/[A-Z]/,t=>t.toLowerCase()):t;r[e]=i(a[t])}),l(s).forEach(t=>{s[t]=i(s[t])}),l(e).forEach(t=>{o[t]=t in s?s[t]:t in r?r[t]:e[t]}),o}(d,u,s||{}),y=this;y.tweens=[];let h=y.tweens,p={},x=o;a&&n&&(x=["touchstart","touchend"]);const v=m.pause,E=m.touch,{gap:T,axis:L}=m.slides,N=m.interval,z=d.getElementsByClassName("item"),b=d.querySelectorAll("[data-slide]"),A=b.length&&b[0],I=b.length&&b[1],C=d.getElementsByClassName("spicr-pages")[0],O=C&&C.querySelectorAll("[data-slide-to]");let P=null,w=null,X=0,$=0;const S=d.classList.contains("spicr-slides"),_=!S&&d.classList.contains("spicr-slider"),F=d.classList.contains("spicr-carousel");function j(){d.classList.contains("paused")||(d.classList.add("paused"),$||(clearInterval(P),P=null))}function D(){d.classList.contains("paused")&&(d.classList.remove("paused"),$||(clearInterval(P),P=null,y.cycle()))}function B(t){if(t.preventDefault(),$)return;const e=t.target,s=e&&e.getAttribute("data-slide-to");e&&!e.classList.contains("active")&&s&&(X=parseInt(s,10),y.slideTo(X))}function M(t){if(t.preventDefault(),$)return;this===I||I.contains(this)?X+=1:(this===A||A.contains(this))&&(X-=1),y.slideTo(X)}function Z(t){p.isTouch||(p.startX=t.changedTouches[0].pageX,d.contains(t.target)&&(p.isTouch=!0,R(1)))}function k(t){p.isTouch&&(p.currentX=t.changedTouches[0].pageX,"touchmove"===t.type&&t.changedTouches.length>1&&t.preventDefault())}function H(t){if(p.isTouch&&!$&&(p.endX=p.currentX||t.changedTouches[0].pageX,p.isTouch)){if((!d.contains(t.target)||!d.contains(t.relatedTarget))&&Math.abs(p.startX-p.endX)<75)return;p.currentX<p.startX?X+=1:p.currentX>p.startX&&(X-=1),p.isTouch=!1,y.slideTo(X),R()}}function R(t){const e=t?"addEventListener":"removeEventListener";d[e]("touchmove",k,r),d[e]("touchend",H,r)}function q(t){const e=t?"addEventListener":"removeEventListener";"hover"===v&&N&&(d[e](x[0],j),d[e](x[1],D)),I&&I[e]("click",M),A&&A[e]("click",M),E&&z.length>1&&d[e]("touchstart",Z,r),C&&C[e]("click",B)}function U(t){Array.from(O).map(t=>t.classList.remove("active")),t&&t.classList.add("active")}function K(t,e){X=e,z[e].classList.add("next"),$=!0,F&&t>-1&&z[t].offsetHeight!==z[e].offsetHeight&&(d.style.height=getComputedStyle(z[t]).height)}function W(t,e){z[e].classList.add("active"),z[e].classList.remove("next"),z[t]&&z[t].classList.remove("active"),setTimeout(()=>{if(F&&(d.style.height=""),S){console.log("options.slides",m.slides);const t=Y();console.log("nextItem (active 1)",e),console.log("ttlItemsFrActive",t);const s=e-t;console.log("indexOfFirstItemOnPg",s);const n=m.slides.itemsPerPage-1;console.log("maxIdxLClones",n);const a=m.slides.itemsPerPage+m.slides.totalRealItems+1-1;if(console.log("minIdxRClones",a),n>=s||s>=a){console.log("chkIsInCloneRange",s,n>=s>=a);const t=s>=a;console.log("isOnRight",t);let o=m.slides.totalRealItems;o=t?-o:o,console.log("moveByTtlItems",o);const r=e+o;X=r,console.log("realNextItem",r);const i=s+o;console.log("realFirstItemPg",i);let l=0;l="x"===L?z[0].offsetWidth:z[0].offsetHeight,console.log("itemLength",l);const c=-1*(i*l+T*i);console.log("pos",T,c),Array.from(z).forEach((t,e)=>{t.style.transform=`translate${L.toUpperCase()}(${c}px)`}),z[e].classList.remove("active"),z[r].classList.add("active"),e=r}}else c.reset(d);$=!1,h=[];const t=new CustomEvent("afterTween",{detail:{newActive:e}});d.dispatchEvent(t),N&&!d.classList.contains("paused")&&y.cycle()},0)}function Y(){let t=0;return"center"===m.slides.activeAlign?t=(m.slides.itemsPerPage-1)/2:"right"===m.slides.activeAlign&&(t=m.slides.itemsPerPage),t}S&&(X=m.slides.itemsPerPage+Y()+1-1,console.log("init index",X)),this.getActiveIndex=()=>{const t=d.getElementsByClassName("item active")[0];return Array.from(z).indexOf(t)},this.cycle=()=>{clearInterval(P),P=setTimeout(()=>{X+=1,y.slideTo(X)},N)},this.slideTo=t=>{console.log("slideTonextIdx",t);let e=t;const s=this.getActiveIndex();console.log(s,e,$),s===e||$||(clearInterval(P),P=setTimeout(()=>{if(s<e||0===s&&e===z.length-1?w=1:(s>e||s===z.length-1&&0===e)&&(w=0),e<0?e=z.length-1:e>=z.length&&(e=0),_){K(s,e);const t=-1!==s?g(z,s,e):g(z,s),n=-1!==s&&g(z,e);-1===s?t.length&&(h=h.concat(t)):(t.length&&(h=h.concat(t)),n.length&&(h=h.concat(n))),h.length?(h.reduce((t,e)=>t._duration+t._delay>e._duration+e._delay?t:e)._onComplete=()=>W(s,e),h.forEach(t=>t.start())):W(s,e),O&&U(O[e])}else if(S)K(s,e),h=c.slides(d,z,s,e,w,L,T),h.length?(h.reduce((t,e)=>t._duration+t._delay>e._duration+e._delay?t:e)._onComplete=()=>W(s,e),h.forEach(t=>t.start())):W(s,e);else if(F){K(s,e);const{delay:t,duration:n,easing:a}=u,o=z[s],r=z[e];h=c.carousel(d,z,s,e,w),h.length?(o&&o.offsetHeight!==r.offsetHeight&&h.push(c.fromTo(d,{height:parseFloat(getComputedStyle(o).height)},{height:parseFloat(getComputedStyle(r).height)},{easing:a,duration:n,delay:Math.max(...h.map(t=>t._delay+t._duration))||t})),h[h.length-1]._onComplete=()=>W(s,e),h.forEach(t=>t.start())):W(s,e),O&&U(O[e])}},1))},this.dispose=()=>{$&&h.forEach(t=>t.stop()),c.reset(d),p={},q(),clearInterval(P),delete d.Spicr},d.Spicr&&d.Spicr.dispose(),q(1),d.Spicr=y,d.getElementsByClassName("item active").length?N&&y.cycle():y.slideTo(0)}if(void 0===window.KUTE)throw Error("Spicr requires KUTE.js ^2.0.10");function h(t){const e=t instanceof Element?t:document;Array.from(e.querySelectorAll('[data-function="spicr"]')).forEach(t=>new y(t))}c.fromTo=window.KUTE.fromTo,c.carousel=function(t,e,s,n,a){const o=[],r=f(t),i={},l={},g={},y={},h=e[s],p=h&&m(h),x=m(e[n]),{translate:v}=r,{rotate:E}=r,{scale:T}=r,L=t.getAttribute("data-transform-origin"),{opacity:N}=r,{easing:z}=r;let b=r.duration||u.duration,A=r.delay||+b/2;if(N&&(i.opacity=1,l.opacity=0,g.opacity=0,y.opacity=1),(T||v||E)&&(i.transform={},l.transform={},g.transform={},y.transform={}),T&&(i.transform.scale=1,l.transform.scale=T,g.transform.scale=T,y.transform.scale=1),v){i.transform.translate3d=[0,0,0];let t=0,e=0,s=0;"x"in v&&(t=a?-v.x:v.x),"y"in v&&(e=a?-v.y:v.y),"Z"in v&&(s=a?-v.z:v.z),l.transform.translate3d=[t,e,s];let n=0,o=0,r=0;"x"in v&&(n=a?v.x:-v.x),"y"in v&&(o=a?v.y:-v.y),"Z"in v&&(r=a?v.z:-v.z),g.transform.translate3d=[n,o,r],y.transform.translate3d=[0,0,0]}if(E){i.transform.rotate3d=[0,0,0];let t=0,e=0,s=0;"x"in E&&(t=a?-E.x:E.x),"y"in E&&(e=a?-E.y:E.y),"Z"in E&&(s=a?-E.z:E.z),l.transform.rotate3d=[t,e,s];let n=0,o=0,r=0;"x"in E&&(n=a?E.x:-E.x),"y"in E&&(o=a?E.y:-E.y),"Z"in E&&(r=a?E.z:-E.z),g.transform.rotate3d=[n,o,r],y.transform.rotate3d=[0,0,0]}a||(p&&p.reverse(),x.reverse()),N||E||v||T||(b=50,A=0);const I={easing:z,duration:b},C=I;return p&&p.forEach((t,e)=>{if(I.delay=u.delay*e,o.push(c.fromTo(t,i,l,I)),L){const e=d(t,L);let s="50%",n="50%";const a="z"in e?` ${e.z}px`:"";"x"in e&&(s=/%/.test(e.x)?e.x:e.x+"px"),"y"in e&&(n=/%/.test(e.y)?e.y:e.y+"px"),t.style.transformOrigin=`${s} ${n}${a}`}}),x.forEach((t,e)=>{if(C.delay=(A+50)*e,o.push(c.fromTo(t,g,y,C)),L){const e=d(t,L);let s="50%",n="50%";const a="z"in e?` ${e.z}px`:"";"x"in e&&(s=/%/.test(e.x)?e.x:e.x+"px"),"y"in e&&(n=/%/.test(e.y)?e.y:e.y+"px"),t.style.transformOrigin=`${s} ${n}${a}`}}),o},c.layer=function(t,e,s){const n=s||f(t),a=t.classList.contains("item-bg"),o={},r={},{translate:i}=n,{rotate:l}=n,{scale:d}=n,{origin:m}=n;let{opacity:g}=n,{duration:y}=n,{easing:h}=n,p=n.delay||(a?0:u.delay);if(/InOut/.test(h)||s||(h=e?h.replace("In","Out"):h.replace("Out","In")),e||(y=a?y:1.5*y),p=e?p:0,g=!e&&a&&s?0:g,g&&(o.opacity=e?0:1,r.opacity=e?1:0),(d||i||l)&&(o.transform={},r.transform={},m)){let e="50%",s="50%";const n="z"in m?` ${m.z}px`:"";"x"in m&&(e=/%/.test(m.x)?m.x:m.x+"px"),"y"in m&&(s=/%/.test(m.y)?m.y:m.y+"px"),t.style.transformOrigin=`${e} ${s}${n}`}if(d&&(o.transform.scale=e?d:1,r.transform.scale=e?1:d),i){const t=e&&i.x?i.x:0,s=i.x&&!e?i.x:0,n=e&&i.y?i.y:0,a=i.y&&!e?i.y:0,l=e&&i.z?i.z:0,c=i.z&&!e?i.z:0;o.transform.translate3d=[t,n,l],r.transform.translate3d=[s,a,c]}if(l){const t=e&&l.x?l.x:0,s=!e&&l.x?l.x:0,n=e&&l.y?l.y:0,a=!e&&l.y?l.y:0,i=e&&l.z?l.z:0,c=!e&&l.z?l.z:0;o.transform.rotate3d=[t,n,i],r.transform.rotate3d=[s,a,c]}return g||l||i||d||(y=50,p=0),c.fromTo(t,o,r,{easing:h,duration:y,delay:p})},c.reset=function(t){Array.from(t.getElementsByClassName("spicr-layer")).forEach(t=>{t.style.opacity="",t.style.transform="",t.style.transformOrigin=""})},c.slides=function(t,e,s,n,a,o,r){const i=[],l=function(t,e){const s=function(t){const e={};return["translate","rotate","scale","transform-origin","opacity","duration","delay","easing","axis"].forEach(s=>{e["transform-origin"===s?"origin":s]=t.getAttribute("data-"+s)}),e}(t),{translate:n,rotate:a,origin:o,opacity:r,easing:i,axis:l}=s;let{scale:c,duration:f,delay:m}=s;return c=parseFloat(c),f=+f,m=+m,{axis:l,translate:n?d(e,n):"",rotate:a?d(t,a):"",origin:o?d(t,o,1):"",scale:Number.isNaN(c)?"":c,opacity:"false"!==r?1:0,duration:Number.isNaN(f)?u.duration:f,delay:Number.isNaN(m)?0:m,easing:i||u.easing}}(t,e[s]),f=e[s],{translate:m}=l,{easing:g}=(t.getAttribute("data-transform-origin"),l),y=l.duration||u.duration,h={},p={},x=getComputedStyle(f).getPropertyValue("transform"),v=new DOMMatrixReadOnly(x),E={X:v.m41,Y:v.m42,Z:v.m43};if(console.log("activeTranslate",E),m){console.log("elem translate",m),h.transform={},p.transform={},h.transform.translate3d=[E.X,E.Y,E.Z];let t=0,s=0,n=0;"x"in m&&("x"===o&&(m.x+=r),t=a?-m.x:m.x),"y"in m&&("y"===o&&(m.y+=r),s=a?-m.y:m.y),"z"in m&&("z"===o&&(m.z+=r),n=a?-m.z:m.z),console.log("elem translate after direction",m);const l=t+E.X,d=s+E.Y,u=n+E.Z;p.transform.translate3d=[l,d,u],console.log("fromTo",h.transform,p.transform),Array.from(e).forEach((t,e)=>{i.push(c.fromTo(t,h,p,{easing:g,duration:y}))})}return i},y.initComponent=h,document.body?h():document.addEventListener("DOMContentLoaded",h,{once:!0});Object.assign(y,{Version:"1.0.10"});export default y;
